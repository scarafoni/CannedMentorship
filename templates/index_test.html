<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
    <script type="text/javascript" src="static/reconnecting-websocket.min.js"></script>
  </head>
  <script>
    //websocket stuff
    var outbox = new ReconnectingWebSocket("ws://"+ location.host + "/submit");
    var inbox = new ReconnectingWebSocket("ws://"+ location.host + "/wsupdate");

    /*
    outbox.onclose = function(){
        console.log('outbox closed');
        this.outbox = new WebSocket(outbox.url);
    };
    */

    inbox.onmessage = function(message) {
        console.log('got it');
        var data = JSON.parse(message.data);
        console.log(data);
    }

    //send an instruction
    $(function() {
        $('#sendProp').on('click', function(event) {
            console.log('click');
            var instruct = $('input[name="input"]').val();
            var u_id = '1';
            outbox.send(JSON.stringify({instruct : instruct, u_id : u_id}));
        });
    });

    /*
    $(function() {
      $('#sendProp').bind('click', function() {
        $.getJSON('/send_my_inst', {
          u_instruct: $('input[name="input"]').val(),
          u_id: String(id),
        }, function(data) {
          $('#uInstruct').val('');
          alert(data.result);
          //$("#uInstruct").text(data.result);
        });
        return false;
      });
    });
    */

  </script>
  </head>
  <body>
    <div id="header" class="jumbotron">
      <div class="container">
        <h1>Canned Mentorship</h1>
        <p>Work with others to write a how-to instruction list for-</br> <strong>How to get from Wilson Commons to the CS minor's lab</strong></p>
      </div>
    </div>
    <div id="content" class="container">
      <div class="row row-offcanvas row-offcanvas-right">
        <div class="col-md-8">
          <table id="instructTable" class="table table-bordered">
            <thead>
              <tr class="info">
                <th>How-to list so far</th>
              </tr>
            </thead>
            <tbody >
            </tbody>
          </table>
          <div class="input-group">
            <input id="uInstruct" type="text" name="input" class="form-control"> 
            <span class="input-group-btn">
                <button id="sendProp" type="button" class="btn btn-primary">
                  Send
                </button>
            </span>
          </div>
          <div id="propFinishDiv">
              <button id="proposeInstruct" type="button" class="btn btn-primary">
              Propose Next Step
              </button>
              <button id="finishButton" type="button" class="btn btn-primary">
                Think the how-to is complete? Click here to finish
              </button>
        </div>
        </div>       
        <div class="col-sm-4 sidebar-offcanvas">
          <h5 id="amILead">stuff</h5>
          <div class="alert alert-info" role="alert">
            <h4><strong>What to do:</strong></h4>
            <h4 id="currStep">stuff</h4>
          </div>
          <div id="voteFinish" class="input-group">
          </div>
          <div class="input-group">
          <table id="voteTable" class="table table-striped">
            <thead>
              <tr><th>suggested answers:</th></tr>
            </thead>
            <tbody>
            </tbody>
          </table>
        </div>
      </div>
    </div>
</body>
</html>
